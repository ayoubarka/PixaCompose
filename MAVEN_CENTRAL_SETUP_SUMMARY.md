# Maven Central Publishing Setup - Complete Summary

## ‚úÖ Completed Tasks

### 1. Gradle Publishing Configuration ‚úÖ

**File**: `library/build.gradle.kts`

- ‚úÖ GroupId set to `com.pixamob`
- ‚úÖ ArtifactId set to `pixacompose`
- ‚úÖ Version loaded from `libs.versions.toml` via `libs.versions.appVersionName.get()`
- ‚úÖ Configured Vanniktech Maven Publish plugin with `CENTRAL_PORTAL` host
- ‚úÖ Automatic release enabled (`automaticRelease = true`)
- ‚úÖ All publications signed (`signAllPublications()`)
- ‚úÖ Complete POM metadata:
  - Name: PixaCompose
  - Description: Comprehensive details
  - URL: GitHub repository
  - License: Apache 2.0
  - Developer: Ayoub Arka
  - SCM: Git URLs
  - Issue Management: GitHub Issues
- ‚úÖ Sources and Javadoc JARs automatically generated by Vanniktech plugin

### 2. Credential Configuration ‚úÖ

**File**: `gradle.properties`

Added placeholders for:
- `mavenCentralUsername`
- `mavenCentralPassword`
- `signing.keyId`
- `signing.password`
- `signing.secretKeyRingFile`

**Local Setup**: Users should add actual credentials to `~/.gradle/gradle.properties`

### 3. GitHub Actions Workflow ‚úÖ

**File**: `.github/workflows/publish.yml`

Features:
- ‚úÖ Triggers on tag push (`v*.*.*`)
- ‚úÖ Manual trigger via `workflow_dispatch`
- ‚úÖ Runs on macOS (required for iOS builds)
- ‚úÖ Sets up JDK 17
- ‚úÖ Validates Gradle wrapper
- ‚úÖ Imports GPG key from base64-encoded secret
- ‚úÖ Builds all targets (Android, iOS)
- ‚úÖ Runs tests (continue on error)
- ‚úÖ Publishes to Maven Central with proper credentials
- ‚úÖ Creates GitHub Release with artifacts
- ‚úÖ Cleanup of GPG keys

**Required GitHub Secrets**:
- `SONATYPE_USERNAME` - Sonatype username
- `SONATYPE_PASSWORD` - Sonatype password/token
- `GPG_PRIVATE_KEY` - Base64-encoded private key
- `GPG_PASSPHRASE` - GPG key passphrase

### 4. Documentation ‚úÖ

#### README.md ‚úÖ
- ‚úÖ Comprehensive installation instructions
- ‚úÖ Quick start guide with examples
- ‚úÖ Component documentation
- ‚úÖ Theming guide
- ‚úÖ Configuration examples
- ‚úÖ Complete publishing section for maintainers
- ‚úÖ Local setup instructions
- ‚úÖ GPG key generation guide
- ‚úÖ CI/CD workflow documentation
- ‚úÖ Troubleshooting section
- ‚úÖ Version management
- ‚úÖ Release checklist

#### PUBLISHING_GUIDE.md ‚úÖ
- ‚úÖ Prerequisites and setup
- ‚úÖ Sonatype account creation
- ‚úÖ Namespace verification
- ‚úÖ GPG key generation and management
- ‚úÖ Local publishing steps
- ‚úÖ CI/CD publishing workflow
- ‚úÖ Troubleshooting common issues
- ‚úÖ Version management
- ‚úÖ Security best practices
- ‚úÖ Release checklist

#### CHANGELOG.md ‚úÖ
- ‚úÖ Follows Keep a Changelog format
- ‚úÖ Initial v1.0.0 release documented
- ‚úÖ Comprehensive feature list
- ‚úÖ Versioning guidelines
- ‚úÖ Pre-release version format

### 5. Git Configuration ‚úÖ

**File**: `.gitignore`

Enhanced with:
- ‚úÖ Gradle build artifacts
- ‚úÖ Kotlin compilation cache
- ‚úÖ IntelliJ IDEA files
- ‚úÖ Android build outputs
- ‚úÖ iOS build outputs
- ‚úÖ macOS system files
- ‚úÖ **Publishing security**: `*.gpg`, `*.key`, signing files
- ‚úÖ Local properties files
- ‚úÖ Configuration cache

---

## üìã Pre-Publishing Checklist

### One-Time Setup

#### 1. Sonatype Account
- [ ] Create account at https://central.sonatype.com/
- [ ] Verify namespace `com.pixamob`
- [ ] Generate User Token (Account ‚Üí Generate User Token)

#### 2. GPG Key
- [ ] Generate GPG key: `gpg --full-generate-key`
- [ ] Note key ID (last 8 characters)
- [ ] Publish public key: `gpg --keyserver keyserver.ubuntu.com --send-keys YOUR_KEY_ID`
- [ ] Export private key for CI: `gpg --export-secret-keys YOUR_KEY_ID | base64 > private-key.txt`
- [ ] Export secret keyring: `gpg --export-secret-keys YOUR_KEY_ID > ~/.gnupg/secring.gpg`

#### 3. Local Configuration
Create `~/.gradle/gradle.properties`:
```properties
mavenCentralUsername=YOUR_USERNAME
mavenCentralPassword=YOUR_PASSWORD
signing.keyId=YOUR_KEY_ID
signing.password=YOUR_PASSPHRASE
signing.secretKeyRingFile=/Users/YOUR_USERNAME/.gnupg/secring.gpg
```

#### 4. GitHub Secrets
Configure in repository Settings ‚Üí Secrets:
- [ ] `SONATYPE_USERNAME`
- [ ] `SONATYPE_PASSWORD`
- [ ] `GPG_PRIVATE_KEY` (base64 content)
- [ ] `GPG_PASSPHRASE`

### For Each Release

#### Prepare Release
- [ ] Update version in `gradle/libs.versions.toml`
- [ ] Update `CHANGELOG.md` with changes
- [ ] Update README if needed
- [ ] Run all tests locally: `./gradlew :library:allTests`
- [ ] Build all targets: `./gradlew :library:build`
- [ ] Test locally: `./gradlew :library:publishToMavenLocal`

#### Publish Release
- [ ] Commit all changes: `git add . && git commit -m "Release v1.0.0"`
- [ ] Create tag: `git tag -a v1.0.0 -m "Release version 1.0.0"`
- [ ] Push: `git push origin main && git push origin v1.0.0`
- [ ] Monitor GitHub Actions workflow
- [ ] Verify deployment in Sonatype Central Portal
- [ ] Wait 10-30 minutes for Maven Central sync
- [ ] Test installation from Maven Central

---

## üöÄ Quick Publishing Commands

### Test Locally
```bash
# Build and test
./gradlew :library:build :library:allTests

# Publish to Maven Local
./gradlew :library:publishToMavenLocal

# Check ~/.m2/repository/com/pixamob/pixacompose/
```

### Publish to Maven Central (Local)
```bash
./gradlew :library:publishToMavenCentral --no-configuration-cache
```

### Automated Publishing (CI)
```bash
# Create and push tag
git tag -a v1.0.0 -m "Release version 1.0.0"
git push origin v1.0.0

# GitHub Actions will automatically:
# 1. Build all targets
# 2. Run tests
# 3. Sign artifacts
# 4. Publish to Maven Central
# 5. Create GitHub Release
```

---

## üì¶ What Gets Published

Each release publishes the following artifacts:

### Android
- `pixacompose-1.0.0-android.aar` - Android library
- `pixacompose-1.0.0-android-sources.jar` - Source code
- `pixacompose-1.0.0-android-javadoc.jar` - Documentation
- `pixacompose-1.0.0-android.module` - Gradle metadata
- `pixacompose-1.0.0-android.pom` - Maven POM

### iOS (iosArm64)
- `pixacompose-iosarm64-1.0.0.klib` - iOS ARM64 library
- `pixacompose-iosarm64-1.0.0-sources.jar` - Source code
- `pixacompose-iosarm64-1.0.0-javadoc.jar` - Documentation
- `pixacompose-iosarm64-1.0.0.module` - Gradle metadata
- `pixacompose-iosarm64-1.0.0.pom` - Maven POM

### iOS (iosX64)
- Similar artifacts for iOS x86_64 (simulator)

### iOS (iosSimulatorArm64)
- Similar artifacts for iOS ARM64 simulator

### All Artifacts Include
- `.asc` files - GPG signatures
- `.md5` and `.sha1` - Checksums
- `.sha256` and `.sha512` - Enhanced checksums

---

## üîç Verification

### After Publishing

1. **Sonatype Central Portal**:
   - Visit: https://central.sonatype.com/
   - Login and check Deployments

2. **Maven Central Search** (10-30 min delay):
   - https://central.sonatype.com/artifact/com.pixamob/pixacompose
   - https://search.maven.org/artifact/com.pixamob/pixacompose

3. **Verify Artifact Contents**:
   ```bash
   # Download and inspect
   curl -O https://repo1.maven.org/maven2/com/pixamob/pixacompose/1.0.0/pixacompose-1.0.0.pom
   cat pixacompose-1.0.0.pom
   ```

4. **Test in Consumer Project**:
   ```kotlin
   // In a test project's build.gradle.kts
   repositories {
       mavenCentral()
   }
   
   dependencies {
       implementation("com.pixamob:pixacompose:1.0.0")
   }
   ```

---

## üîê Security Best Practices

### Credentials
- ‚úÖ Never commit credentials to version control
- ‚úÖ Use `~/.gradle/gradle.properties` for local credentials
- ‚úÖ Use GitHub Secrets for CI credentials
- ‚úÖ Rotate credentials regularly
- ‚úÖ Use strong passphrases

### GPG Keys
- ‚úÖ Backup private key securely (offline)
- ‚úÖ Use strong passphrase
- ‚úÖ Set expiration date (2-5 years recommended)
- ‚úÖ Publish to multiple keyservers
- ‚úÖ Revoke immediately if compromised

### GitHub Secrets
- ‚úÖ Minimal permissions
- ‚úÖ Regular rotation
- ‚úÖ Never log in CI output
- ‚úÖ Review access logs

---

## üìû Support

### Issues
- **Technical Issues**: [GitHub Issues](https://github.com/ayoubarka/PixaCompose/issues)
- **Publishing Issues**: Check PUBLISHING_GUIDE.md troubleshooting section
- **Sonatype Support**: [Sonatype Help](https://central.sonatype.org/support/)

### Contact
- **Email**: ayoub@pixamob.com
- **GitHub**: [@ayoubarka](https://github.com/ayoubarka)

---

## ‚úÖ Final State

Your PixaCompose project is now **100% ready** for Maven Central publishing via Sonatype Central Portal:

‚úÖ Proper group/artifact configuration (`com.pixamob:pixacompose`)  
‚úÖ Version management via version catalog  
‚úÖ Automatic sources and javadoc JAR generation  
‚úÖ GPG signing configured  
‚úÖ Complete POM metadata  
‚úÖ Sonatype Central Portal integration  
‚úÖ GitHub Actions CI/CD workflow  
‚úÖ Comprehensive documentation  
‚úÖ Security best practices  
‚úÖ Git configured with proper .gitignore  

**Next Steps**:
1. Complete one-time setup (Sonatype account, GPG key, GitHub Secrets)
2. Update version number for first release
3. Create and push git tag
4. Monitor GitHub Actions workflow
5. Verify publication on Maven Central

**Estimated Time to First Publication**: 30-60 minutes (including Maven Central sync)

---

**Last Updated**: January 9, 2025  
**Version**: 1.0.0  
**Status**: ‚úÖ Production Ready

